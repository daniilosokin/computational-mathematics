# Вычислительная математика. Лабораторная работа №3

## Решение систем линейных уравнений. Часть 2

### Применение LU разложения

$LU$-разложение может быть использовано не только для решения систем
линейных уравнений.

$LU$–разложение может быть использовано для нахождения обратной
матрицы.

Обращение матрицы $A$ эквивалентно решению линейной системы

$$
AX=E\text{,}
$$

где $X$ — неизвестная матрица, $E$ — единичная матрица. Решение $X$ этой
системы является обратной матрицей $A^{-1}$.

Систему можно решить описанным выше методом $LU$-разложения.
Вычисление определителя матрицы

Имея $LU$-разложение матрицы $A=LU$, можно непосредственно вычислить её
определитель:

$$
det(A)=det(LU)=det(L)det(U)={l_{11}}\cdot{...}\cdot{l_{nn}}\cdot{u_{11}}\cdot{...}\cdot{u_{nn}}
$$

То есть определитель матрицы $А$ равен произведению элементов по главной
диагонали матрицы $U$.

### QR разложение матрицы

Матрица A размера ${n}\times{n}$ с комплексными элементами может быть
представлена в виде $A=QR$, где $Q$ — унитарная матрица размера ${n}\times{n}$, 
а $R$ — верхнетреугольная матрица размера ${n}\times{n}$.

В частном случае, когда матрица $A$ состоит из вещественных чисел, $Q$
является ортогональной матрицей.

По аналогии, можно определить варианты этого разложения: $QL$-, $RQ$-,
и $LQ$-разложения, где $L$ — нижнетреугольная матрица.

Напомню, что матрица А является ортогональной матрицей, тогда и только
тогда, когда выполняется одно из следующих эквивалентных условий:
- строчки матрицы А образуют ортонормированный базис;
- столбцы матрицы А образуют ортонормированный базис;
- $A^{-1}=A^{t}$
- ${A^{-1}}\cdot{A^{t}}=E$

Нахождение $QR$ разложения невырожденной матрицы $А$ является
эквивалентом метода ортогонализации Грама-Шмидта. Если рассматривать
столбцы (строки) матрицы $А$ как линейно независимую систему векторов, то
к этой системе можно применить метод ортогонализации Грама-Шмидта, и
получить матрицу, состоящую из векторов ортонормированного базиса
(матрицу $Q$). Тогда для нахождения матрицы $R$ достаточно найти
произведение $AQ^{t}$ (это следует из того, что
${A=QR}\Rightarrow{AQ^{-1}}={R}\Rightarrow{R}=AQ^{t}$)

### Решение системы линейных уравнений методом простых итераций

Рассмотрим один из простых методов – метод простой итерации.

Пусть дана система линейных уравнений, имеющая вид:

$$
\begin{cases} 
a_{11}x_{1} + a_{12}x_{2} + \dots + a_{1n}x_{n} = b_{1} 
\\ 
a_{21}x_{1} + a_{22}x_{2} + \dots + a_{2n}x_{n} = b_{2} 
\\
\dots
\\
a_{1n}x_{1} + a_{2n}x_{2} + \dots + a_{nn}x_{n} = b_{n}
\end{cases} \qquad \text{(1)}
$$

Эта система эквивалентна векторной (матричной) записи $AX=B$
Данную систему можно преобразовать к виду $X=CX+F$, где $С$ – некоторая
матрица, $F$ - вектор-столбец, то есть система принимает форму

$$
X = Ф(X) \text{,} \qquad \text{(2)}
$$

где $Ф(X)=CX+F$.

Пусть $X_{0}$ – начальное приближение (произвольным образом заданный
вектор-решение $X$). Получим последовательность:

$$
\begin{matrix}
X_{1} = Ф(X_{0}) \\
X_{2} = Ф(X_{1}) \\
\dots \\
X_{n} = Ф(X_{n-1})
\end{matrix}
$$

Аналогичную последовательность получается при решении нелинейного
уравнения методом простой итерации $x=\phi(x)$.

Возникает только вопрос о том, как привести систему (1) к виду удобному
для итераций виду (2). В общем случае это не простая задача, требующая
специальных знаний, но в некоторых случаях можно поступить очень просто.
Например, можно сделать такие преобразования:

$AX=B$ заменить на $(A-E+E)X=B$ ,то есть из матрицы $А$ вычли и
прибавили единичную матрицу.

$$
\begin{matrix}
(A – E) \cdot X + E \cdot X = B
E \cdot X = -(A - E) \cdot X + B
X = (E - A) \cdot X + B
\end{matrix}
$$

Можно использовать другой способ (метод Якоби).
Из первого уравнения системы (1) выразим неизвестное $x_{1}$, 
из второго $x_{2}$ и так далее. В результате получим систему:

$$
\begin{cases} 
x_{1} = \frac{1}{a_{11}}(-a_{12}x_{2} - \dots - a_{1n}x_{n} + b_{1})
\\ 
x_{2} = \frac{1}{a_{22}}(-a_{21}x_{1} - a_{23}x_{3} - \dots - a_{2n}x_{n} + b_{2})
\\
\dots
\\
x_{n} = \frac{1}{a_{nn}}(-a_{n1}x_{1} - \dots - a_{nn}x_{n-1} + b_{1})
\end{cases} \qquad \text{(3)}
$$

Или $X=CX+F$, где $C$ - матрица ${n}\times{n}$, $F$ – вектор-столбец. На главной
диагонали матрицы С стоят нули, а ненулевые элементы выражают по формулам:
$c_{ij}=-\frac{a_{ij}}{a_{ii}}\text{ , }f_{i}=\frac{b_{i}}{a_{ii}}\text{.}\qquad\text{(4)}$

Для выполнения данного преобразования необходимо чтобы диагональные
элементы исходной матрицы не были нулевыми. Если матрица
преобразована к виду (3) по данным формулам (4), то метод итераций
называют методом Якоби.

Для системы (1) метод итерации сходится, если модули диагональных
коэффициентов для каждого уравнения системы больше суммы модулей всех
остальных коэффициентов (не считая свободных членов).

В качестве критерия окончания расчета (достижения заданной точности)
можно использовать простое соотношение
$|x_{n+1}-x_{n}<e|$

### Метод Зейделя

Модификацией метода простых итераций Якоби можно считать метод
Зейделя. В методе Якоби на $(k+1)$-ой итерации значения 
$x_{i}^{k+1}(i=1,2,\dots,n)$ вычисляются подстановкой в правую часть
системы (2) вычисленных на предыдущей итерации значений $x_{i}^{k}$.

В методе Зейделя при вычислении $x_{i}^{k+1}$ используются значенитя
$x_{1}^{k+1}$, $x_{2}^{k+1}$, $x_{i-1}^{k+1}$, уже найденные
на $(k+1)$-ой итерации, т.е. $(k+1)$-е приближение строится
следующим образом:

$$
\begin{cases} 
x_{1}^{k+1} = c_{12}x_{2}^{k} + \dots + c_{1n}x_{n}^{k} + f_{1}
\\ 
x_{2}^{k+1} = c_{21}x_{1}^{k+1} + c_{23}x_{3}^{k} + \dots + c_{2n}x_{n}^{k} + f_{2}
\\
x_{3}^{k+1} = c_{31}x_{1}^{k+1} + c_{32}x_{2}^{k+1} + c_{34}x_{4}^{k} + \dots + f_{3}
\\
x_{n}^{k+1} = c_{n1}x_{1}^{k+1} + \dots + c_{nn-1}x_{n-1}^{k+1} + f_{n}
\end{cases} \qquad \text{(5)}
$$

Запишем нижнюю и верхнюю треугольные матрицы

$$
\begin{pmatrix}
0 & 0 & 0 & \dots & 0
\\ 
c_{21} & 0 & 0 & \dots & 0
\\
c_{31} & c_{32} & 0 & \dots & 0
\\
\dots & \dots & \dots & \dots & \dots
\\
c_{n1} & c_{n2} & c_{n2} & \dots & 0
\end{pmatrix}
\text { и }
\begin{pmatrix}
0 & c_{12} & c_{13} & \dots & c_{1n}
\\ 
0 & 0 & c_{23} & \dots & c_{2n}
\\
0 & 0 & 0 & \dots & c_{3n}
\\
\dots & \dots & \dots & \dots & \dots
\\
0 & 0 & 0 & \dots & 0
\end{pmatrix}
$$

Тогда перепишем (5) в матричном виде

$$
X^{k+1} = C_{1}X^{k+1} + C_{2}X^{k} + F \qquad \text{(6)} 
$$

Достаточным условием сходимости метода Зейделя является выполнение
неравенства: $max\text{ }|c_{ij}|<1$
Это означает, что для сходимости метода Зейделя
достаточно, чтобы максимальный по модулю элемент матрицы $С=С1+С2$
был меньше единицы

Критерий окончания расчета можно взять такой же, как и в методе Якоби.
Метод Зейделя, как правило, сходится быстрее, чем метод Якоби. Однако
возможны ситуации, когда метод Якоби сходится, а метод Зейделя сходится
медленнее или вообще расходится

## Задание

**Вариант №9:**

1. Создать квадратную матрицу из случайных целых чисел из $[2,8]$ размера $7$. Найти её определитель, используя $LU$ разложение.

2. Найдите $QR$ разложение матрицы, созданной в пункте $1$. Проверьте правильность найденного разложения:
- с помощью умножения $Q$ на $R$
- с помощью функции ```np.linalg.qr```

3. Решить систему, используя метод простых итераций с точностью $10^{-3}$, приведя к виду, удобному для итераций.

$$
\begin{matrix}
3.6 х_{1} + 1.8 х_{2} - 4.7 х_{3} = 3.8 \\
2.7 х_{1} - 3.6 х_{2} + 1.9 х_{3} = 0.4 \\
1.5 х_{1} + 4.5 х_{2} + 3.3 х_{3} = -1.6
\end{matrix}
$$
