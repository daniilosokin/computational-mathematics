# Вычислительная математика. Лабораторная работа №4

## Интреполяционные многочлены Ньютона и Лагранжа

Раассмотрим систему несовпадющих точек $x_{i}, i=1,\dots,N$ из некоторой
области $D$. Пусть значения функции $f$ известны только в этих точках:
$f(x_{i})=y_{i}$.

Задача интерполяции состоит поиске такой функции $F$ из заданного класса
функций, что $F(x_{i})=y_{i}$.

Точки $x_{i}, i=1,\dots,N$ называют узлами интерполяции, а их совокупность —
интерполяционной сеткой.

Пары $(x_{i}, y_{i})$ называют точками данных или базовыми точками.

Разность между «соседними» значениями ${\Delta}x_{i}=x_{i}-x_{i-1}$
называется шагом интерполяционной сетки. Он может быть как
переменным, так и постоянным.

Функцию $F(x)$ — интерполирующей функцией или интерполянтом.

### Интерполяционный многочлен Лагранжа для нераноотстоящих узлов


Пусть функция $f$ задана следующей таблицей:
|        |         |         |         |         |
| ---    | ---     | ---     | ---     | ---     |
| $x$    | $x_{0}$ | $x_{1}$ | $\dots$ | $x_{n}$ |
| $f(x)$ | $y_{0}$ | $y_{1}$ | $\dots$ | $y_{n}$ |

Построим интерполяционный многочлен $L_{n}(x)$, степень которого
не больше $n$ и для которого выполнены условия:

$$
F(x_{0}) = y_{o}, F(x_{1})=y_{1}, \dots, F(x_{n})=y_{n} \text{,} \qquad \text{(1)}
$$

Будем искать $L(x)$ в виде

$$
L_{n}(x) = l_{o}(x) + l_{1}(x)+l_{2}(x) + \dots + l_{n}(x) \text{,} \qquad \text{(2)}
$$

где $l_(i)$ многочлен степени n, причем

$$
l_{i}(x_{k}) =
\begin{cases}
y_{i}, \text { если } i = k
\\
0, \text { если } i \neq k
\end{cases} \qquad \text{(3)}
$$

Очевидно, что требование (3) с учетом (2) вполне обеспечивает выполнение условий (1).

Многочлены l_{i}(х) составим следующим способом:

$$
l_{i}(x) = c_{i}(x-x_{0})(x-x_{1})) \cdot \dots \cdot 
(х-х_{i-1})(х-х_{i+1}) \cdot \dots \cdot (x-x_{n}), \qquad \text{(4)}
$$

где $с_{i}$ - постоянный коэффициент, значение которого найдем
из первой части условия (3):

$$
c_{i} = \frac{y_{i}}{(x_{i}-x_{0})} \cdot \dots \cdot
(x_{i} - x_{i-1})(x_{i} - x_{i+1}) \cdot \dots \cdot (x_{i}-x_{0})
$$

(заметим, что ни один множитель в знаменателе не равен нулю).

Подставим $с_{i}$ в (4) и далее с учетом (2) окончательно имеем:

$$
L_{n}(x) = \sum_{i=0}^{n} y_{i} \cdot 
\frac{(x-x_{0}) \cdot \dots \cdot (x-x_{i-1})(x-x_{i+1}) \cdot \dots \cdot (x-x_{n})}{(x_{i}-x_{0}) \cdot \dots \cdot (x_{i}-x_{i-1})(x_{i}-x_{i+1}) \cdot \dots \cdot (x_{i}-x_{n})}
\qquad \text{(5)}
$$

В общем виде он записывается следующим образом:

$$
L_{n}(x) = \sum_{i=0}^{n} y_{i} \cdot
\prod_{j=0}^{n} \frac{(x - x_{j})}{(x_{i}-x_{j})}, 
\text{ при } i \neq j \qquad \text{(6)}
$$

Это и есть интерполяционный многочлен Лагранжа для неравностоящих узлов.

### Интерполяционный полином Ньютона для раноотстоящих узлов

#### Первя интерполяционная формула Ньютона (интерполяция вперёд)


Пусть для функции, заданной таблицей с постоянным шагом, составлена таблица конечных разностей.

| $x$      | $y$     | ${\Delta}y_{i}$ | ${\Delta}^{2}y_{i}$ | ${\Delta}^{2}y_{i}$ | $\dots$ |
| ---      | ---     | ---             | ---                 | ---                 | ---     |
| $x_{0}$  | $y_{0}$ | ${\Delta}y_{0}$ | ${\Delta}^{2}y_{0}$ | ${\Delta}^{2}y_{0}$ | $\dots$ |
| $x_{1}$  | $y_{1}$ | ${\Delta}y_{1}$ | ${\Delta}^{2}y_{1}$ | ${\Delta}^{2}y_{1}$ | $\dots$ |
| $x_{2}$  | $y_{2}$ | ${\Delta}y_{2}$ | ${\Delta}^{2}y_{2}$ | $\dots$             | $\dots$ |
| $x_{3}$  | $y_{3}$ | ${\Delta}y_{3}$ | $\dots$             | $\dots$             | $\dots$ |
| $x_{4}$  | $y_{4}$ | $\dots$         | $\dots$             | $\dots$             | $\dots$ |
| $\dots$  | $\dots$ | $\dots$         | $\dots$             | $\dots$             | $\dots$ |


Будем искать интерполяционный многочлен в виде:

$$
P_{n}(x) = a_{0} + a_{1}(x-x_{0}) + a_{2}(x-x_{0})(x-x_{1}) +
\dots + a_{n}(x-x_{o}) \cdot \dots \cdot (х-х_{n-1})
\qquad \text{(12)}
$$

Это многочлен $n$-й степени. Значения коэффициентов 
$а_{0},а_{1},\dots,а_{n}$ найдем из условия совпадения значений 
исходной функции и многочлена в узлах. Полагая $х=х_{0}$, из (12) 
находим $y_{0}=P_{n}(x_{0})=a_{0}$, откуда $а_{0}=y_{0}$. Далее, 
придавая $х$ значения $х_{1}$ и $х_{2}$, последовательно получаем:

$$
у_{1}=Р_{n}(x_{1}) = a_{0} + a_{1}(x_{1} - x_{0}),
$$

откуда

$$
а_{1} = \frac{y_{1} - a_{0}}{x_{1} - x_{0}} =
\frac{y_{1} - a_{0}}{x_{1} - x_{0}} = \frac{\Delta y_{0}}{h};
$$

$$
y_{2} = P_{n}(x_{2}) = a_{0} + a_{1}(x_{2} - x_{0}) +
a_{2}(x_{2} - x_{0})(x_{2} - x_{1}),
$$

$$
a_{2} = \frac{y_{2} - a_{0} - a_{1}(x_{2} - x_{0})}{(x_{2}-x_{0})(x_{2}-x_{1})} =
\frac{y_{2} - y_{0} - \frac{{\Delta}y_{0} \cdot 2h}{h}}{2lh^{2}} =
\frac{(y_{2} - y_{0}) - 2y_{1} + 2y_{0}}{2! h^{2}} =
\frac{y_{2} - 2y_{1} + y_{0}}{2! h^{2}} = \frac{{\Delta}^{2} y_{0}}{2! h^{2}}
$$


Далее, проведя аналогичные выкладки, можно получить:

$$
a_{3} = \frac{{\Delta}^{3} y_{0}}{3! h^{3}}
$$

в общем случае выражение для a_{k} будет иметь вид:

$$
a_{3} = \frac{{\Delta}^{k} y_{0}}{k! h^{k}}
\qquad \text{(13)}
$$

Подставим теперь (13) в выражение для многочлена (12):

$$
P_{n}(x) = y_{0} + \frac{{\Delta} y_{0}}{h}(x - x_{0}) +
\frac{{\Delta}^{2} y_{0}}{2! h^{2}} (x - x_{0})(x - x_{0}) + 
\dots + \frac{{\Delta}^{n} y_{0}}{n! h^{n}} (x - x_{0}) \cdot
\dots \cdot (x - x_{n-1})
\qquad \text{(14)}
$$


Практически эта формула применяется в несколько ином виде.

Положим, $\frac{x-x_{0}}{h}=t$, т.е. $x=x_{0}+ht$. Тогда:

$$
\frac{x-x_{1}}{h} = \frac{x-x_{0}-h}{h} = t - 1,
$$

$$
\frac{x-x_{2}}{h} = \frac{x-x_{0}-2h}{h} = t - 2
$$

и т.д.

Окончательно имеем:

$$
P_{n}(x) = P_{n}(x_{0} + th) = y_{0} + t {\Delta} y_{0} +
\frac{t(t-1)}{2!} {\Delta}^{2} y_{0} + \dots +
\frac{t(t-1) \cdot \dots \cdot (t - n + 1)}{n!} {\Delta}^{n} y_{0}
\qquad \text{(14)}
$$

Формула (14) называется *первой интерполяционной формулой Ньютона*.
Эта формула применяется для интерполирования в начале отрезка
интерполяции, когда $t$ мало по абсолютной величине. Первую 
интерполяционную формулу Ньютона называют по этой причине формулой
для интерполирования вперед.

#### Вторая интерполяционная формула Ньютона (интерполяция назад)


Когда значение аргумента находится ближе к концу отрезка интерполяции, 
применять первую интерполяционную формулу становится невыгодно. В этом
случае применяется формула для интерполирования назад *вторая* 
*интерполяционная формула Ньютона*, которая отыскивается в виде:

$$
P_{n}(x) = a_{0} - a_{1}(x - x_{n}) + a_{2}(x - x_{n})(x - x_{n-1}) + 
\dots + a_{n}(x-x_{n}) \cdot \dots \cdot (x-x_{1}),
\qquad \text{(15)}
$$

Как и для первой формулы Ньютона, коэффициенты $а_{0},а_{1},\dots,a_{n}$ 
находятся из условия совпадения значений функции и интерполяционного
многочлена в узлах интерполяции:

$$
a_{k} = \frac{{\Delta}^{k} y_{k}}{k! h^{k}}
\qquad \text{(16)}
$$

Подставляя (16) в (15) и переходя к переменной получим
окончательный вид второй интерполяционной формулы Ньютона:

$$
P_{n}(x) = P_{n}(x_{n}+th) = y_{n} + t {\Delta} y_{n-1} +
\frac{t(t+1)}{2!} {\Delta}^{2} y_{n-2} + {\Lambda} +
\frac{t(t+1) \cdot \dots \cdot (t + n - 1)}{n!} {\Delta}^{n} y_{0}
\qquad \text{(17)}
$$


## Задание

**Вариант №5:**

1. Используя интерполяционную формулу Лагранжа для неравноотстоящих узлов:
- построить многочлен Лагранжа (вывести формулу) 
- вывести график
- вычислить значения функции при данных значениях аргумента

| $x$  | $y$     |
| ---  | ---     |
| 0.68 | 0.80866 |
| 0.73 | 0.89492 |
| 0.80 | 1.02964 |
| 0.88 | 1.20966 |
| 0.93 | 1.34087 |
| 0.99 | 1.52368 |


|       |       |       |       |       |
| ---   | ---   | ---   | ---   | ---   |
| $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ |
| 0.896 | 0.812 | 0.774 | 0.955 | 0.715 |


2. Используя первую или вторую интерполяционную формулу 
Ньютона вычислить указанные значения функции при данных значениях аргумента

| $x$  | $y$     |
| ---  | ---     |
| 3.50 | 33.1154 |
| 3.55 | 34.8133 |
| 3.60 | 36.5982 |
| 3.65 | 38.4747 |
| 3.70 | 40.4473 |
| 3.75 | 42.5211 |
| 3.80 | 44.7012 |
| 3.85 | 46.9931 |
| 3.90 | 49.4024 |
| 3.95 | 51.5982 |
| 4.00 | 57.3975 |
| 4.10 | 60.3403 |
| 4.15 | 63.4340 |
| 4.20 | 66.6863 |


|       |       |       |       |
| ---   | ---   | ---   | ---   |
| $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| 3.522 | 4.176 | 3.475 | 4.250 |
